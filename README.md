
# üß± ResNetTrunk

[![PyTorch](https://img.shields.io/badge/PyTorch-1.12+-ee4c2c?logo=pytorch&logoColor=white)](https://pytorch.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Status](https://img.shields.io/badge/Status-Active-brightgreen)]()
[![Stars](https://img.shields.io/github/stars/abobantai/ResNet-constructors?style=social)]()
[![Forks](https://img.shields.io/github/forks/abobantai/ResNet-constructors?style=social)]()

---

## üìö –û–ø–∏—Å–∞–Ω–∏–µ

–ö–∞—Å—Ç–æ–º–Ω—ã–π, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä **ResNet-–ø–æ–¥–æ–±–Ω—ã—Ö —Å–µ—Ç–µ–π** –Ω–∞ PyTorch.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ (`block`),
- –ª—é–±—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (—á–∏—Å–ª–æ –±–ª–æ–∫–æ–≤, –∫–∞–Ω–∞–ª—ã, —Å—Ç—Ä–∞–π–¥—ã),
- –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏–ª–∏ —Å–ª–æ—è–º–∏).

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –≤ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç
```

---

## üî• –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```python
from model import create

# –ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å
net = create(
    num_blocks=[2, 2, 2],
    num_classes=100,
    act1="relu",
    act2="silu"
)

print(net)
```

---

## ‚öôÔ∏è –ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ `create`

| –ü–∞—Ä–∞–º–µ—Ç—Ä      | –¢–∏–ø             | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------------|------------------|----------|
| `block`       | –∫–ª–∞—Å—Å             | –ë–ª–æ–∫ —Å–µ—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `ResBlockV1`) |
| `strides`     | —Å–ø–∏—Å–æ–∫ int        | –°—Ç—Ä–∞–π–¥—ã —ç—Ç–∞–ø–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `[1]*len(num_blocks)`) |
| `num_blocks`  | —Å–ø–∏—Å–æ–∫ int        | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ |
| `channels`    | —Å–ø–∏—Å–æ–∫ int        | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–∞–ª–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ |
| `koef`        | —Å–ø–∏—Å–æ–∫ int        | –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ —à–∏—Ä–∏–Ω—ã –∫–∞–Ω–∞–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `[1]*len(num_blocks)`) |
| `num_classes` | int               | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ |
| `act1`        | —Å—Ç—Ä–æ–∫–∞/—Å–ª–æ–π       | –ü–µ—Ä–≤–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –≤ –±–ª–æ–∫–µ |
| `act2`        | —Å—Ç—Ä–æ–∫–∞/—Å–ª–æ–π       | –í—Ç–æ—Ä–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –≤ –±–ª–æ–∫–µ |

---

## üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

| –ú–æ–¥—É–ª—å                | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------------------|----------|
| `ResTruck`             | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ç–∏: –Ω–∞—á–∞–ª—å–Ω–∞—è —Å–≤–µ—Ä—Ç–∫–∞, –±–ª–æ–∫–∏, –≥–ª–æ–±–∞–ª—å–Ω—ã–π pooling. |
| `Resnet_construct`     | –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. |
| `get_activation`       | –£–ø—Ä–æ—â–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–π. |
| `create`               | –£–¥–æ–±–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è —Å–±–æ—Ä–∫–∏ –º–æ–¥–µ–ª–∏. |

---

## üé® –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

–ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É:

- `"relu"`
- `"silu"`
- `"gelu"`
- `"leaky_relu"`

–ò–ª–∏ —Å—Ä–∞–∑—É —Å–≤–æ–π —Å–ª–æ–π:

```python
from torch.nn import PReLU

model = create(
    num_blocks=[2, 2, 2],
    act1=PReLU(),
    act2="gelu"
)
```

---

## üß† –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –º–æ–¥–µ–ª–∏

```python
# –ì–ª—É–±–æ–∫–∞—è —Å–µ—Ç—å –ø–æ–¥ ImageNet
net = create(
    num_blocks=[3, 4, 6, 3],
    strides=[1, 2, 2, 2],
    channels=[64, 128, 256, 512],
    koef=[1, 2, 4, 8],
    num_classes=1000,
    act1="leaky_relu",
    act2="silu"
)
```

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ [MIT License](LICENSE).

---

## –û–ø–∏—Å–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–ª–æ–∫–æ–≤

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —à–µ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–µ—Ä—Å–∏–π Residual-–±–ª–æ–∫–æ–≤:

### 1. `ResBlockV1`
- **–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –±–ª–æ–∫** (–ø–æ—Ö–æ–∂–µ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π ResNet).
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:  
  `Conv ‚Üí BatchNorm ‚Üí Activation ‚Üí Conv ‚Üí BatchNorm ‚Üí Koef-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí Add(Shortcut) ‚Üí Activation`.
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —Å–≤–µ—Ä—Ç–∫–∏ –∏ –ø–æ—Å–ª–µ —Å–ª–æ–∂–µ–Ω–∏—è).
- Shortcut –≤–∫–ª—é—á–∞–µ—Ç 1x1 —Å–≤–µ—Ä—Ç–∫—É, –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç.

---

### 2. `ResBlockV2`
- **–£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–ª–æ–∫–∞ –±–µ–∑ –≤—Ç–æ—Ä–æ–π BatchNorm.**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:  
  `Conv ‚Üí BatchNorm ‚Üí Activation ‚Üí Conv ‚Üí Koef-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí Add(Shortcut) ‚Üí Activation`.
- –ò—Å–∫–ª—é—á–µ–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–π —Å–≤–µ—Ä—Ç–∫–∏ (`bn2` –Ω–µ—Ç).
- Shortcut –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π: 1x1 —Å–≤–µ—Ä—Ç–∫–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

### 3. `ResBlockV3`
- **–ë–ª–æ–∫ —Å –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π –ø–µ—Ä–µ–¥ —Å–ª–æ–∂–µ–Ω–∏–µ–º.**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:  
  `Conv ‚Üí BatchNorm ‚Üí Activation ‚Üí Conv ‚Üí BatchNorm ‚Üí Koef-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí Activation ‚Üí Add(Shortcut)`.
- –û—Ç–ª–∏—á–∏–µ: –ø—Ä–∏–º–µ–Ω—è–µ–º –∞–∫—Ç–∏–≤–∞—Ü–∏—é –ø–µ—Ä–µ–¥ —Å–ª–æ–∂–µ–Ω–∏–µ–º —Å Shortcut (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω–æ–π —Å—Ö–µ–º—ã ResNet).

---

### 4. `ResBlockV4`
- **–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –±–ª–æ–∫ –±–µ–∑ –≤—Ç–æ—Ä–æ–π BatchNorm –∏ —Å –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π –ø–µ—Ä–µ–¥ —Å–ª–æ–∂–µ–Ω–∏–µ–º.**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:  
  `Conv ‚Üí BatchNorm ‚Üí Activation ‚Üí Conv ‚Üí Koef-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí Activation ‚Üí Add(Shortcut)`.
- –ù–µ—Ç –≤—Ç–æ—Ä–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è —Å—Ç–æ–∏—Ç –¥–æ —Å–ª–æ–∂–µ–Ω–∏—è.
- Shortcut —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π.

---

### 5. `ResBlockV5`
- **–ë–ª–æ–∫ –±–µ–∑ –≤—Ç–æ—Ä–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:  
  `Conv ‚Üí BatchNorm ‚Üí Activation ‚Üí Conv ‚Üí BatchNorm ‚Üí Koef-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí Add(Shortcut)`.
- –ü–æ—Å–ª–µ —Å–ª–æ–∂–µ–Ω–∏—è **–Ω–µ—Ç** –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤–æ–æ–±—â–µ.
- Shortcut —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π.

---

### 6. `ResBlockV6`
- **–°–∞–º—ã–π —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –±–ª–æ–∫: –±–µ–∑ –≤—Ç–æ—Ä–æ–π BatchNorm –∏ –±–µ–∑ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ—Å–ª–µ —Å–ª–æ–∂–µ–Ω–∏—è.**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:  
  `Conv ‚Üí BatchNorm ‚Üí Activation ‚Üí Conv ‚Üí Koef-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí Add(Shortcut)`.
- –ù–µ—Ç –≤—Ç–æ—Ä–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (`bn2`) –∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ—Å–ª–µ —Å–ª–æ–∂–µ–Ω–∏—è.
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ–ø–µ—Ä–∞—Ü–∏–π.

---

- **`act1`** –∏ **`act2`** ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –∑–∞–¥–∞—é—Ç—Å—è —è–≤–Ω–æ –∏–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`ReLU`).

